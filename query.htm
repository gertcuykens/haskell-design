<!DOCTYPE html>
<!-- Copyright(c) gert.cuykens@gmail.com -->
<html>
 <head>
  <title>query</title>
  <script src="table.js"></script>
  <style>
   thead td{background-color:silver;
            background-position:0px 2px;
            background-repeat:no-repeat;
            text-align:center;
            padding:0px 10px 0px 10px;}
  </style>
 </head>
 <body>
  <div style="text-align:right;margin-right:6px">
   <textarea id="sql" style="width:100%" rows="5" cols="5">select name, uid from users;</textarea>
   <input type="button" value="run" onclick="submit()"/>
  </div>
  <script>
   var console=document.createElement('pre')
   console.log=function(v){this.innerHTML+=v+'\n'}
   document.body.appendChild(table)
   document.body.appendChild(console)
   var myWebSocket= new WebSocket('ws://localhost:8000')
   myWebSocket.onopen=function(e){console.log('connection open')}
   myWebSocket.onmessage=function(e){
    console.log(e.data)
    var v=JSON.parse(e.data)
    v.connections?null:table.insert(v)
   }
   myWebSocket.onclose=function(e){console.log('connection closed')}
   submit=function()
   {
    table.drop()
    myWebSocket.send(document.getElementById('sql').value)
   }
  </script>
 </body>
</html>
